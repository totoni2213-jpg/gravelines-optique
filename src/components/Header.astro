---
const navLinks = [
  { href: '/',         label: 'Accueil' },
  { href: '/boutique', label: 'La Boutique' },
  { href: '/marques',  label: 'Marques' },
  { href: '/services', label: 'Services' },
  { href: '/sav',      label: 'SAV' },
  { href: '/articles', label: 'Actualit√©s' },
  { href: '/contact',  label: 'Contact' },
];

const currentPath = Astro.url.pathname;

function isActive(href: string) {
  if (href === '/') return currentPath === '/';
  return currentPath.startsWith(href);
}
---

<!-- Thin gold top accent line -->
<div class="fixed top-0 left-0 right-0 z-[60] h-[2px] bg-gradient-to-r from-transparent via-gold to-transparent opacity-70"></div>

<header
  id="site-header"
  class="fixed top-[2px] left-0 right-0 z-50 bg-dark/90 backdrop-blur-md border-b border-white/[0.06]"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-[72px]">

      <!-- Logo -->
      <a href="/" class="flex items-center gap-3.5 group flex-shrink-0">
        <div class="relative">
          <img
            src="/logos/logo-gravelines-optique.png"
            alt="Gravelines Optique"
            class="h-10 w-auto transition-all duration-300 group-hover:scale-105"
            style="filter: brightness(0) invert(1);"
          />
        </div>
        <div class="hidden sm:flex flex-col">
          <span class="text-white font-serif text-[17px] leading-tight tracking-wide group-hover:text-gold transition-colors duration-300">Gravelines Optique</span>
          <span class="text-gold/70 text-[10px] font-medium tracking-[0.18em] uppercase">Montivilliers</span>
        </div>
      </a>

      <!-- Desktop Navigation -->
      <nav class="hidden lg:flex items-center gap-0.5" aria-label="Navigation principale">
        {navLinks.map((link) => (
          <a
            href={link.href}
            class={`relative px-3.5 py-2 text-[13px] font-medium tracking-wide transition-all duration-200 rounded-sm group
              ${isActive(link.href)
                ? 'text-gold'
                : 'text-white/65 hover:text-white'
              }`}
          >
            {link.label}
            {/* Active indicator dot */}
            <span class={`absolute bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full bg-gold transition-all duration-300
              ${isActive(link.href) ? 'opacity-100 scale-100' : 'opacity-0 scale-0 group-hover:opacity-40 group-hover:scale-75'}`}
            ></span>
            {/* Hover background */}
            <span class={`absolute inset-0 rounded-sm bg-white/0 group-hover:bg-white/[0.04] transition-colors duration-200 -z-10
              ${isActive(link.href) ? 'bg-white/[0.04]' : ''}`}
            ></span>
          </a>
        ))}
      </nav>

      <!-- CTA + Hamburger -->
      <div class="flex items-center gap-2.5">
        <!-- Phone CTA -->
        <a
          href="tel:0235209978"
          class="hidden md:flex items-center gap-2 bg-gold hover:bg-gold-dark text-dark text-[12.5px] font-bold px-4 py-2.5 rounded-sm transition-all duration-200 tracking-wide hover:shadow-[0_4px_16px_rgba(201,169,97,0.4)] hover:-translate-y-[1px]"
        >
          <svg class="w-3.5 h-3.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
            <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"/>
          </svg>
          02 35 20 99 78
        </a>

        <!-- Hamburger -->
        <button
          id="menu-btn"
          class="lg:hidden flex flex-col gap-[5px] p-2.5 text-white hover:text-gold transition-colors group"
          aria-label="Ouvrir le menu"
          aria-expanded="false"
        >
          <span class="block w-5 h-[1.5px] bg-current transition-all duration-300 group-hover:w-6"></span>
          <span class="block w-6 h-[1.5px] bg-current"></span>
          <span class="block w-4 h-[1.5px] bg-current transition-all duration-300 group-hover:w-6"></span>
        </button>
      </div>
    </div>
  </div>
</header>

<!-- Mobile overlay -->
<div id="menu-overlay" class="hidden fixed inset-0 z-40 bg-black/60 backdrop-blur-sm lg:hidden"></div>

<!-- Mobile Menu -->
<div
  id="mobile-menu"
  class="fixed top-[74px] left-0 right-0 z-[45] lg:hidden bg-dark/98 backdrop-blur-xl border-b border-white/10 shadow-dark"
>
  <nav class="px-4 py-4">
    <div class="space-y-0.5">
      {navLinks.map((link) => (
        <a
          href={link.href}
          class={`flex items-center justify-between px-4 py-3.5 text-sm font-medium rounded-sm transition-all duration-200
            ${isActive(link.href)
              ? 'text-gold bg-gold/8 border-l-2 border-gold pl-3.5'
              : 'text-white/70 hover:text-white hover:bg-white/[0.04] border-l-2 border-transparent pl-3.5'
            }`}
        >
          {link.label}
          {isActive(link.href) && (
            <svg class="w-3.5 h-3.5 text-gold/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
          )}
        </a>
      ))}
    </div>

    <div class="mt-4 pt-4 border-t border-white/10 flex flex-col gap-2.5 px-4">
      <a
        href="tel:0235209978"
        class="flex items-center justify-center gap-2.5 bg-gold hover:bg-gold-dark text-dark font-bold py-3.5 rounded-sm transition-colors text-sm tracking-wide"
      >
        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
          <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"/>
        </svg>
        02 35 20 99 78
      </a>
      <a
        href="/contact"
        class="flex items-center justify-center gap-2 border border-white/15 text-white/70 hover:text-white hover:border-white/30 py-3 rounded-sm transition-colors text-sm"
      >
        Prendre rendez-vous
      </a>
    </div>
  </nav>
</div>

<style>
  /* Slightly increase clickable area for hamburger */
  #menu-btn { touch-action: manipulation; }
</style>
