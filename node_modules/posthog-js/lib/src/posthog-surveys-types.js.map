{"version":3,"file":"posthog-surveys-types.js","sourceRoot":"","sources":["../../src/posthog-surveys-types.ts"],"names":[],"mappings":";AAAA;;;;GAIG;;;AAKH,IAAY,eAGX;AAHD,WAAY,eAAe;IACvB,wCAAqB,CAAA;IACrB,gDAA6B,CAAA;AACjC,CAAC,EAHW,eAAe,+BAAf,eAAe,QAG1B;AAiBD,IAAY,gBAIX;AAJD,WAAY,gBAAgB;IACxB,qCAAiB,CAAA;IACjB,+BAAW,CAAA;IACX,yCAAqB,CAAA;AACzB,CAAC,EAJW,gBAAgB,gCAAhB,gBAAgB,QAI3B;AAED,IAAY,cAWX;AAXD,WAAY,cAAc;IACtB,sCAAoB,CAAA;IACpB,wCAAsB,CAAA;IACtB,0CAAwB,CAAA;IACxB,4CAA0B,CAAA;IAC1B,8CAA4B,CAAA;IAC5B,gDAA8B,CAAA;IAC9B,+BAAa,CAAA;IACb,mCAAiB,CAAA;IACjB,iCAAe,CAAA;IACf,mDAAiC,CAAA;AACrC,CAAC,EAXW,cAAc,8BAAd,cAAc,QAWzB;AAED,IAAY,iBAKX;AALD,WAAY,iBAAiB;IACzB,gCAAW,CAAA;IACX,kCAAa,CAAA;IACb,oCAAe,CAAA;IACf,sCAAiB,CAAA;AACrB,CAAC,EALW,iBAAiB,iCAAjB,iBAAiB,QAK5B;AAwBD,IAAY,UAKX;AALD,WAAY,UAAU;IAClB,iCAAmB,CAAA;IACnB,yBAAW,CAAA;IACX,+BAAiB,CAAA;IACjB,gDAAkC,CAAA;AACtC,CAAC,EALW,UAAU,0BAAV,UAAU,QAKrB;AA2CD,IAAY,kBAMX;AAND,WAAY,kBAAkB;IAC1B,mCAAa,CAAA;IACb,wDAAkC,CAAA;IAClC,oDAA8B,CAAA;IAC9B,uCAAiB,CAAA;IACjB,mCAAa,CAAA;AACjB,CAAC,EANW,kBAAkB,kCAAlB,kBAAkB,QAM7B;AAED,IAAY,2BAKX;AALD,WAAY,2BAA2B;IACnC,6DAA8B,CAAA;IAC9B,0CAAW,CAAA;IACX,+DAAgC,CAAA;IAChC,qEAAsC,CAAA;AAC1C,CAAC,EALW,2BAA2B,2CAA3B,2BAA2B,QAKtC;AAwCD,IAAY,cAIX;AAJD,WAAY,cAAc;IACtB,+BAAa,CAAA;IACb,yCAAuB,CAAA;IACvB,mCAAiB,CAAA;AACrB,CAAC,EAJW,cAAc,8BAAd,cAAc,QAIzB;AAuFD,IAAY,eAKX;AALD,WAAY,eAAe;IACvB,yCAAsB,CAAA;IACtB,iDAA8B,CAAA;IAC9B,uCAAoB,CAAA;IACpB,iDAA8B,CAAA;AAClC,CAAC,EALW,eAAe,+BAAf,eAAe,QAK1B;AAED,IAAY,qBAYX;AAZD,WAAY,qBAAqB;IAC7B,iDAAwB,CAAA;IACxB,qDAA4B,CAAA;IAC5B,6DAAoC,CAAA;IACpC,+DAAsC,CAAA;IACtC,qFAA4D,CAAA;IAC5D,mFAA0D,CAAA;IAC1D,uEAA8C,CAAA;IAC9C,+DAAsC,CAAA;IACtC,+DAAsC,CAAA;IACtC,6DAAoC,CAAA;IACpC,yEAAgD,CAAA;AACpD,CAAC,EAZW,qBAAqB,qCAArB,qBAAqB,QAYhC;AAED,IAAY,iBAGX;AAHD,WAAY,iBAAiB;IACzB,wCAAmB,CAAA;IACnB,sCAAiB,CAAA;AACrB,CAAC,EAHW,iBAAiB,iCAAjB,iBAAiB,QAG5B","sourcesContent":["/**\n * Having Survey types in types.ts was confusing tsc\n * and generating an invalid module.d.ts\n * See https://github.com/PostHog/posthog-js/issues/698\n */\n\nimport type { Properties, PropertyMatchType } from './types'\nimport type { SurveyAppearance as CoreSurveyAppearance, SurveyValidationRule } from '@posthog/core'\n\nexport enum SurveyEventType {\n    Activation = 'events',\n    Cancellation = 'cancelEvents',\n}\n\n// Extended operator type to include numeric operators not in PropertyMatchType\nexport type PropertyOperator = PropertyMatchType | 'gt' | 'lt'\n\nexport type PropertyFilters = {\n    [propertyName: string]: {\n        values: string[]\n        operator: PropertyOperator\n    }\n}\n\nexport interface SurveyEventWithFilters {\n    name: string\n    propertyFilters?: PropertyFilters\n}\n\nexport enum SurveyWidgetType {\n    Button = 'button',\n    Tab = 'tab',\n    Selector = 'selector',\n}\n\nexport enum SurveyPosition {\n    TopLeft = 'top_left',\n    TopRight = 'top_right',\n    TopCenter = 'top_center',\n    MiddleLeft = 'middle_left',\n    MiddleRight = 'middle_right',\n    MiddleCenter = 'middle_center',\n    Left = 'left',\n    Center = 'center',\n    Right = 'right',\n    NextToTrigger = 'next_to_trigger',\n}\n\nexport enum SurveyTabPosition {\n    Top = 'top',\n    Left = 'left',\n    Right = 'right',\n    Bottom = 'bottom',\n}\n\n// Extends core SurveyAppearance with browser-specific fields\n// Omit 'position' from core because browser's SurveyPosition has additional values (e.g., NextToTrigger)\nexport interface SurveyAppearance extends Omit<CoreSurveyAppearance, 'position'> {\n    // Browser-specific fields not in core\n    /** @deprecated - not currently used */\n    descriptionTextColor?: string\n    ratingButtonHoverColor?: string\n    whiteLabel?: boolean\n    tabPosition?: SurveyTabPosition\n    fontFamily?: string\n    maxWidth?: string\n    zIndex?: string\n    disabledButtonOpacity?: string\n    boxPadding?: string\n    /** @deprecated Use inputBackground instead (inherited from core) */\n    inputBackgroundColor?: string\n    // Hide the X (cancel) button - defaults to false (show the button)\n    hideCancelButton?: boolean\n    // Browser's SurveyPosition has more options than core (e.g., NextToTrigger)\n    position?: SurveyPosition\n}\n\nexport enum SurveyType {\n    Popover = 'popover',\n    API = 'api',\n    Widget = 'widget',\n    ExternalSurvey = 'external_survey',\n}\n\nexport type SurveyQuestion = BasicSurveyQuestion | LinkSurveyQuestion | RatingSurveyQuestion | MultipleSurveyQuestion\n\nexport type SurveyQuestionDescriptionContentType = 'html' | 'text'\n\ninterface SurveyQuestionBase {\n    question: string\n    id?: string\n    description?: string | null\n    descriptionContentType?: SurveyQuestionDescriptionContentType\n    optional?: boolean\n    buttonText?: string\n    branching?: NextQuestionBranching | EndBranching | ResponseBasedBranching | SpecificQuestionBranching\n    validation?: SurveyValidationRule[]\n}\n\nexport interface BasicSurveyQuestion extends SurveyQuestionBase {\n    type: SurveyQuestionType.Open\n}\n\nexport interface LinkSurveyQuestion extends SurveyQuestionBase {\n    type: SurveyQuestionType.Link\n    link?: string | null\n}\n\nexport interface RatingSurveyQuestion extends SurveyQuestionBase {\n    type: SurveyQuestionType.Rating\n    display: 'number' | 'emoji'\n    scale: 2 | 3 | 5 | 7 | 10\n    lowerBoundLabel: string\n    upperBoundLabel: string\n    skipSubmitButton?: boolean\n}\n\nexport interface MultipleSurveyQuestion extends SurveyQuestionBase {\n    type: SurveyQuestionType.SingleChoice | SurveyQuestionType.MultipleChoice\n    choices: string[]\n    hasOpenChoice?: boolean\n    shuffleOptions?: boolean\n    skipSubmitButton?: boolean\n}\n\nexport enum SurveyQuestionType {\n    Open = 'open',\n    MultipleChoice = 'multiple_choice',\n    SingleChoice = 'single_choice',\n    Rating = 'rating',\n    Link = 'link',\n}\n\nexport enum SurveyQuestionBranchingType {\n    NextQuestion = 'next_question',\n    End = 'end',\n    ResponseBased = 'response_based',\n    SpecificQuestion = 'specific_question',\n}\n\ninterface NextQuestionBranching {\n    type: SurveyQuestionBranchingType.NextQuestion\n}\n\ninterface EndBranching {\n    type: SurveyQuestionBranchingType.End\n}\n\ninterface ResponseBasedBranching {\n    type: SurveyQuestionBranchingType.ResponseBased\n    responseValues: Record<string, any>\n}\n\ninterface SpecificQuestionBranching {\n    type: SurveyQuestionBranchingType.SpecificQuestion\n    index: number\n}\n\nexport type SurveyCallback = (surveys: Survey[], context?: { isLoaded: boolean; error?: string }) => void\n\nexport interface SurveyElement {\n    text?: string\n    $el_text?: string\n    tag_name?: string\n    href?: string\n    attr_id?: string\n    attr_class?: string[]\n    nth_child?: number\n    nth_of_type?: number\n    attributes?: Record<string, any>\n    event_id?: number\n    order?: number\n    group_id?: number\n}\n\n// Re-export from @posthog/types to avoid duplication\nexport type { SurveyRenderReason } from '@posthog/types'\n\nexport enum SurveySchedule {\n    Once = 'once',\n    Recurring = 'recurring',\n    Always = 'always',\n}\n\nexport interface Survey {\n    // Sync this with the backend's SurveyAPISerializer!\n    id: string\n    name: string\n    description: string\n    type: SurveyType\n    feature_flag_keys:\n        | {\n              key: string\n              value?: string\n          }[]\n        | null\n    // the linked flag key is the flag key that is used to link the survey to a flag\n    linked_flag_key: string | null\n    targeting_flag_key: string | null\n    // the internal targeting flag key is the flag key that is used to target users who have seen the survey\n    // eg survey-targeting-<survey-id>\n    internal_targeting_flag_key: string | null\n    questions: SurveyQuestion[]\n    appearance: SurveyAppearance | null\n    conditions: {\n        url?: string\n        selector?: string\n        seenSurveyWaitPeriodInDays?: number\n        urlMatchType?: PropertyMatchType\n        /** events that trigger surveys */\n        events: {\n            repeatedActivation?: boolean\n            values: SurveyEventWithFilters[]\n        } | null\n        /** events that cancel \"pending\" (time-delayed) surveys */\n        cancelEvents: {\n            values: SurveyEventWithFilters[]\n        } | null\n        actions: {\n            values: SurveyActionType[]\n        } | null\n        deviceTypes?: string[]\n        deviceTypesMatchType?: PropertyMatchType\n        linkedFlagVariant?: string\n    } | null\n    start_date: string | null\n    end_date: string | null\n    current_iteration: number | null\n    current_iteration_start_date: string | null\n    schedule?: SurveySchedule | null\n    enable_partial_responses?: boolean | null\n}\n\nexport type SurveyWithTypeAndAppearance = Pick<Survey, 'id' | 'type' | 'appearance'>\n\nexport interface SurveyActionType {\n    id: number\n    name: string | null\n    steps?: ActionStepType[]\n}\n\n/** Sync with plugin-server/src/types.ts */\nexport type ActionStepStringMatching = 'contains' | 'exact' | 'regex'\n\nexport interface ActionStepType {\n    event?: string | null\n    selector?: string | null\n    /** pre-compiled regex pattern for matching selector against $elements_chain */\n    selector_regex?: string | null\n    /** @deprecated Only `selector` should be used now. */\n    tag_name?: string\n    text?: string | null\n    /** @default StringMatching.Exact */\n    text_matching?: ActionStepStringMatching | null\n    href?: string | null\n    /** @default ActionStepStringMatching.Exact */\n    href_matching?: ActionStepStringMatching | null\n    url?: string | null\n    /** @default StringMatching.Contains */\n    url_matching?: ActionStepStringMatching | null\n    /** Property filters for action step matching */\n    properties?: {\n        key: string\n        value?: string | number | boolean | (string | number | boolean)[] | null\n        operator?: PropertyMatchType\n        type?: string\n    }[]\n}\n\nexport enum SurveyEventName {\n    SHOWN = 'survey shown',\n    DISMISSED = 'survey dismissed',\n    SENT = 'survey sent',\n    ABANDONED = 'survey abandoned',\n}\n\nexport enum SurveyEventProperties {\n    SURVEY_ID = '$survey_id',\n    SURVEY_NAME = '$survey_name',\n    SURVEY_RESPONSE = '$survey_response',\n    SURVEY_ITERATION = '$survey_iteration',\n    SURVEY_ITERATION_START_DATE = '$survey_iteration_start_date',\n    SURVEY_PARTIALLY_COMPLETED = '$survey_partially_completed',\n    SURVEY_SUBMISSION_ID = '$survey_submission_id',\n    SURVEY_QUESTIONS = '$survey_questions',\n    SURVEY_COMPLETED = '$survey_completed',\n    PRODUCT_TOUR_ID = '$product_tour_id',\n    SURVEY_LAST_SEEN_DATE = '$survey_last_seen_date',\n}\n\nexport enum DisplaySurveyType {\n    Popover = 'popover',\n    Inline = 'inline',\n}\n\ninterface DisplaySurveyOptionsBase {\n    ignoreConditions: boolean\n    ignoreDelay: boolean\n    displayType: DisplaySurveyType\n    /** Additional properties to include in all survey events (shown, sent, dismissed) */\n    properties?: Properties\n    /** Pre-filled responses by question index (0-based) */\n    initialResponses?: Record<number, SurveyResponseValue>\n}\n\nexport interface DisplaySurveyPopoverOptions extends DisplaySurveyOptionsBase {\n    displayType: DisplaySurveyType.Popover\n    /** Override the survey's configured position */\n    position?: SurveyPosition\n    /** CSS selector for the element to position the survey next to (when position is NextToTrigger) */\n    selector?: string\n    /** When true, `survey shown` events will not be emitted automatically */\n    skipShownEvent?: boolean\n}\n\ninterface DisplaySurveyInlineOptions extends DisplaySurveyOptionsBase {\n    displayType: DisplaySurveyType.Inline\n    selector: string\n}\n\nexport type DisplaySurveyOptions = DisplaySurveyPopoverOptions | DisplaySurveyInlineOptions\n\nexport interface SurveyConfig {\n    prefillFromUrl?: boolean\n    /**\n     * @deprecated No longer used. Surveys will automatically advance past\n     * prefilled questions with skipSubmitButton enabled. If partial response\n     * collection is enabled, partial responses for pre-filled questions will\n     * be submitted automatically on page load.\n     */\n    autoSubmitIfComplete?: boolean\n    /**\n     * @deprecated No longer used. Pre-filled responses are now sent\n     * immediately when partial responses are enabled, or all required\n     * quesions have been pre-filled.\n     */\n    autoSubmitDelay?: number\n}\n\nexport type SurveyResponseValue = string | number | string[] | null\n"]}