{"version":3,"file":"MessagesView.js","sourceRoot":"","sources":["../../../../../../src/extensions/conversations/external/components/MessagesView.tsx"],"names":[],"mappings":";;;;;;;;;;;;;AA0DA,oCA6CC;;AAnGD,yDAAuD;AACvD,6CAA2C;AAC3C,iCAA4C;AAiB5C,SAAS,aAAa,CAAC,EAQtB;QAPG,OAAO,aAAA,EACP,MAAM,YAAA,EACN,YAAY,kBAAA;IAMZ,IAAM,UAAU,GAAG,OAAO,CAAC,WAAW,KAAK,UAAU,CAAA;IACrD,IAAM,YAAY,yBACX,MAAM,CAAC,OAAO,GACd,CAAC,UAAU,CAAC,CAAC,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,CACjE,CAAA;IACD,IAAM,YAAY,yBACX,MAAM,CAAC,cAAc,GACrB,CAAC,UAAU,CAAC,CAAC,CAAC,MAAM,CAAC,sBAAsB,CAAC,CAAC,CAAC,MAAM,CAAC,mBAAmB,CAAC,CAC/E,CAAA;IAED,OAAO,CACH,iCAAsB,KAAK,EAAE,YAAY,aACpC,CAAC,UAAU,IAAI,OAAO,CAAC,WAAW,IAAI,gCAAK,KAAK,EAAE,MAAM,CAAC,aAAa,YAAG,OAAO,CAAC,WAAW,GAAO,EACpG,gCAAK,KAAK,EAAE,YAAY,YACpB,uBAAC,yBAAW,IACR,WAAW,EAAE,OAAO,CAAC,YAAY,EACjC,OAAO,EAAE,OAAO,CAAC,OAAO,EACxB,UAAU,EAAE,UAAU,EACtB,YAAY,EAAE,YAAY,GAC5B,GACA,EACN,gCAAK,KAAK,EAAE,MAAM,CAAC,WAAW,YAAG,IAAA,0BAAkB,EAAC,OAAO,CAAC,UAAU,CAAC,GAAO,KAVxE,OAAO,CAAC,EAAE,CAWd,CACT,CAAA;AACL,CAAC;AAED,SAAgB,YAAY,CAAC,EAaT;QAZhB,MAAM,YAAA,EACN,YAAY,kBAAA,EACZ,eAAe,qBAAA,EACf,QAAQ,cAAA,EACR,UAAU,gBAAA,EACV,SAAS,eAAA,EACT,KAAK,WAAA,EACL,aAAa,mBAAA,EACb,SAAS,eAAA,EACT,aAAa,mBAAA,EACb,cAAc,oBAAA,EACd,QAAQ,cAAA;IAER,OAAO,CACH,6DACI,iCAAK,KAAK,EAAE,MAAM,CAAC,QAAQ,aACtB,QAAQ,CAAC,GAAG,CAAC,UAAC,OAAO,IAAK,OAAA,CACvB,uBAAC,aAAa,IAAkB,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,YAAY,IAAxE,OAAO,CAAC,EAAE,CAAkE,CACnG,EAF0B,CAE1B,CAAC,EACF,gCAAK,GAAG,EAAE,cAAc,GAAI,IAC1B,EAEL,KAAK,IAAI,gCAAK,KAAK,EAAE,MAAM,CAAC,KAAK,YAAG,KAAK,GAAO,EAEjD,iCAAK,KAAK,EAAE,MAAM,CAAC,cAAc,aAC7B,qCACI,GAAG,EAAE,QAAQ,EACb,KAAK,EAAE,MAAM,CAAC,KAAK,EACnB,WAAW,EAAE,eAAe,EAC5B,KAAK,EAAE,UAAU,EACjB,OAAO,EAAE,aAAa,EACtB,SAAS,EAAE,SAAS,EACpB,IAAI,EAAE,CAAC,EACP,QAAQ,EAAE,SAAS,GACrB,EACF,uBAAC,qCAAiB,IACd,YAAY,EAAE,YAAY,EAC1B,UAAU,EAAE,UAAU,EACtB,SAAS,EAAE,SAAS,EACpB,iBAAiB,EAAE,aAAa,GAClC,IACA,IACP,CACN,CAAA;AACL,CAAC","sourcesContent":["// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { h, Fragment } from 'preact'\nimport { Message } from '../../../../posthog-conversations-types'\nimport { getStyles } from './styles'\nimport { SendMessageButton } from './SendMessageButton'\nimport { RichContent } from './RichContent'\nimport { formatRelativeTime } from './utils'\n\ninterface MessagesViewProps {\n    styles: ReturnType<typeof getStyles>\n    primaryColor: string\n    placeholderText: string\n    messages: Message[]\n    inputValue: string\n    isLoading: boolean\n    error: string | null\n    onInputChange: (e: Event) => void\n    onKeyDown: (e: KeyboardEvent) => void\n    onSendMessage: () => void\n    messagesEndRef: (el: HTMLDivElement | null) => void\n    inputRef: (el: HTMLTextAreaElement | null) => void\n}\n\nfunction MessageBubble({\n    message,\n    styles,\n    primaryColor,\n}: {\n    message: Message\n    styles: ReturnType<typeof getStyles>\n    primaryColor: string\n}) {\n    const isCustomer = message.author_type === 'customer'\n    const messageStyle = {\n        ...styles.message,\n        ...(isCustomer ? styles.messageCustomer : styles.messageAgent),\n    }\n    const contentStyle = {\n        ...styles.messageContent,\n        ...(isCustomer ? styles.messageContentCustomer : styles.messageContentAgent),\n    }\n\n    return (\n        <div key={message.id} style={messageStyle}>\n            {!isCustomer && message.author_name && <div style={styles.messageAuthor}>{message.author_name}</div>}\n            <div style={contentStyle}>\n                <RichContent\n                    richContent={message.rich_content}\n                    content={message.content}\n                    isCustomer={isCustomer}\n                    primaryColor={primaryColor}\n                />\n            </div>\n            <div style={styles.messageTime}>{formatRelativeTime(message.created_at)}</div>\n        </div>\n    )\n}\n\nexport function MessagesView({\n    styles,\n    primaryColor,\n    placeholderText,\n    messages,\n    inputValue,\n    isLoading,\n    error,\n    onInputChange,\n    onKeyDown,\n    onSendMessage,\n    messagesEndRef,\n    inputRef,\n}: MessagesViewProps) {\n    return (\n        <>\n            <div style={styles.messages}>\n                {messages.map((message) => (\n                    <MessageBubble key={message.id} message={message} styles={styles} primaryColor={primaryColor} />\n                ))}\n                <div ref={messagesEndRef} />\n            </div>\n\n            {error && <div style={styles.error}>{error}</div>}\n\n            <div style={styles.inputContainer}>\n                <textarea\n                    ref={inputRef}\n                    style={styles.input}\n                    placeholder={placeholderText}\n                    value={inputValue}\n                    onInput={onInputChange}\n                    onKeyDown={onKeyDown}\n                    rows={1}\n                    disabled={isLoading}\n                />\n                <SendMessageButton\n                    primaryColor={primaryColor}\n                    inputValue={inputValue}\n                    isLoading={isLoading}\n                    handleSendMessage={onSendMessage}\n                />\n            </div>\n        </>\n    )\n}\n"]}