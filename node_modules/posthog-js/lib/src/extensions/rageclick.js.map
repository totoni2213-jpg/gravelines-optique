{"version":3,"file":"rageclick.js","sourceRoot":"","sources":["../../../src/extensions/rageclick.ts"],"names":[],"mappings":";AAAA,mFAAmF;AACnF,iEAAiE;AACjE,0BAA0B;;AAE1B,sCAAwC;AAGxC,IAAM,oBAAoB,GAAG,EAAE,CAAA;AAC/B,IAAM,kBAAkB,GAAG,IAAI,CAAA;AAC/B,IAAM,mBAAmB,GAAG,CAAC,CAAA;AAE7B;IAQI,mBAAY,eAA0C;QAClD,IAAI,CAAC,QAAQ,GAAG,eAAe,KAAK,KAAK,CAAA;QACzC,IAAM,IAAI,GAAG,IAAA,eAAQ,EAAC,eAAe,CAAC,CAAC,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,EAAE,CAAA;QAE7D,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,YAAY,IAAI,oBAAoB,CAAA;QAC5D,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,UAAU,IAAI,kBAAkB,CAAA;QACtD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,IAAI,mBAAmB,CAAA;QAEzD,IAAI,CAAC,MAAM,GAAG,EAAE,CAAA;IACpB,CAAC;IAED,+BAAW,GAAX,UAAY,CAAS,EAAE,CAAS,EAAE,SAAiB;QAC/C,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;YAChB,OAAO,KAAK,CAAA;QAChB,CAAC;QAED,IAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA;QACrD,IACI,SAAS;YACT,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,WAAW;YACxE,SAAS,GAAG,SAAS,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,EAClD,CAAC;YACC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,GAAA,EAAE,CAAC,GAAA,EAAE,SAAS,WAAA,EAAE,CAAC,CAAA;YAErC,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,KAAK,IAAI,CAAC,UAAU,EAAE,CAAC;gBACzC,OAAO,IAAI,CAAA;YACf,CAAC;QACL,CAAC;aAAM,CAAC;YACJ,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,GAAA,EAAE,CAAC,GAAA,EAAE,SAAS,WAAA,EAAE,CAAC,CAAA;QACvC,CAAC;QAED,OAAO,KAAK,CAAA;IAChB,CAAC;IACL,gBAAC;AAAD,CAAC,AAzCD,IAyCC","sourcesContent":["// Naive rage click implementation: If mouse has not moved further than thresholdPx\n// over clickCount clicks with max timeoutMs between clicks, it's\n// counted as a rage click\n\nimport { isObject } from '@posthog/core'\nimport { RageclickConfig } from '../types'\n\nconst DEFAULT_THRESHOLD_PX = 30\nconst DEFAULT_TIMEOUT_MS = 1000\nconst DEFAULT_CLICK_COUNT = 3\n\nexport default class RageClick {\n    clicks: { x: number; y: number; timestamp: number }[]\n\n    thresholdPx: number\n    timeoutMs: number\n    clickCount: number\n    disabled: boolean\n\n    constructor(rageclickConfig: RageclickConfig | boolean) {\n        this.disabled = rageclickConfig === false\n        const conf = isObject(rageclickConfig) ? rageclickConfig : {}\n\n        this.thresholdPx = conf.threshold_px || DEFAULT_THRESHOLD_PX\n        this.timeoutMs = conf.timeout_ms || DEFAULT_TIMEOUT_MS\n        this.clickCount = conf.click_count || DEFAULT_CLICK_COUNT\n\n        this.clicks = []\n    }\n\n    isRageClick(x: number, y: number, timestamp: number): boolean {\n        if (this.disabled) {\n            return false\n        }\n\n        const lastClick = this.clicks[this.clicks.length - 1]\n        if (\n            lastClick &&\n            Math.abs(x - lastClick.x) + Math.abs(y - lastClick.y) < this.thresholdPx &&\n            timestamp - lastClick.timestamp < this.timeoutMs\n        ) {\n            this.clicks.push({ x, y, timestamp })\n\n            if (this.clicks.length === this.clickCount) {\n                return true\n            }\n        } else {\n            this.clicks = [{ x, y, timestamp }]\n        }\n\n        return false\n    }\n}\n"]}