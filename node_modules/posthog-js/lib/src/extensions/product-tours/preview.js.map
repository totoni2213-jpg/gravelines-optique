{"version":3,"file":"preview.js","sourceRoot":"","sources":["../../../../src/extensions/product-tours/preview.tsx"],"names":[],"mappings":";;;;;;;;;;;;;AAoBA,4DAoEC;;AAxFD,iCAAoC;AAGpC,+CAA2D;AAC3D,oEAAkE;AAClE,sFAAoF;AACpF,gFAA8E;AAC9E,6DAAuH;AAEvH,IAAM,QAAQ,GAAG,kBAAqB,CAAA;AAWtC,SAAgB,wBAAwB,CAAC,EAOP;QAN9B,IAAI,UAAA,EACJ,UAAU,gBAAA,EACV,aAAa,mBAAA,EACb,iBAAa,EAAb,SAAS,mBAAG,CAAC,KAAA,EACb,kBAAc,EAAd,UAAU,mBAAG,CAAC,KAAA,EACd,KAAK,WAAA;IAEL,aAAa,CAAC,SAAS,GAAG,EAAE,CAAA;IAE5B,IAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;IAChD,IAAA,yDAAmC,EAAC,UAAU,EAAE,UAAU,CAAC,CAAA;IAC3D,aAAa,CAAC,WAAW,CAAC,UAAU,CAAC,CAAA;IACrC,IAAM,MAAM,GAAG,UAAU,CAAC,YAAY,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAA;IAExD,IAAM,UAAU,GAAG,IAAA,8CAAwB,GAAE,CAAA;IAC7C,IAAI,UAAU,EAAE,CAAC;QACb,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAAA;IAClC,CAAC;IAED,IAAM,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAA;IAClD,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,CAAA;IAEhC,IAAM,YAAY,GAAG,IAAI,CAAC,IAAI,KAAK,QAAQ,CAAA;IAC3C,IAAM,YAAY,GAAG,IAAI,CAAC,IAAI,KAAK,QAAQ,CAAA;IAC3C,IAAM,OAAO,GAAG,CAAC,IAAA,sCAAgB,EAAC,IAAI,CAAC,CAAA;IACvC,IAAM,YAAY,GAAG,yBAAkB,OAAO,CAAC,CAAC,CAAC,yBAAyB,CAAC,CAAC,CAAC,EAAE,SAAG,YAAY,CAAC,CAAC,CAAC,sBAAsB,CAAC,CAAC,CAAC,EAAE,CAAE,CAAA;IAE9H,IAAI,YAAY,EAAE,CAAC;QACf,IAAA,eAAM,EACF,gCAAK,KAAK,EAAC,mBAAmB,YAC1B,uBAAC,qCAAiB,IAAC,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE,cAAO,CAAC,GAAI,GACpD,EACN,YAAY,CACf,CAAA;QACD,OAAM;IACV,CAAC;IAED,IAAA,eAAM,EACF,gCAAK,KAAK,EAAC,mBAAmB,YAC1B,gCACI,KAAK,EAAE,YAAY,EACnB,KAAK,sBACD,QAAQ,EAAE,UAAU,EACpB,SAAS,EAAE,MAAM,IACd,CAAC,IAAI,CAAC,QAAQ,IAAI,EAAE,KAAK,EAAE,UAAG,IAAI,CAAC,QAAQ,OAAI,EAAE,QAAQ,EAAE,UAAG,IAAI,CAAC,QAAQ,OAAI,EAAE,CAAC,GAClF,KAAK,aAGX,YAAY,CAAC,CAAC,CAAC,CACZ,uBAAC,uDAA0B,IACvB,IAAI,EAAE,IAAI,EACV,UAAU,EAAE,UAAU,EACtB,SAAS,EAAE,SAAS,EACpB,UAAU,EAAE,UAAU,GACxB,CACL,CAAC,CAAC,CAAC,CACA,uBAAC,iDAAuB,IACpB,IAAI,EAAE,IAAI,EACV,UAAU,EAAE,UAAU,EACtB,SAAS,EAAE,SAAS,EACpB,UAAU,EAAE,UAAU,GACxB,CACL,GACC,GACJ,EACN,YAAY,CACf,CAAA;AACL,CAAC","sourcesContent":["import { render, JSX } from 'preact'\n\nimport { ProductTourStep, ProductTourAppearance } from '../../posthog-product-tours-types'\nimport { document as _document } from '../../utils/globals'\nimport { ProductTourBanner } from './components/ProductTourBanner'\nimport { ProductTourSurveyStepInner } from './components/ProductTourSurveyStepInner'\nimport { ProductTourTooltipInner } from './components/ProductTourTooltipInner'\nimport { getProductTourStylesheet, addProductTourCSSVariablesToElement, hasElementTarget } from './product-tours-utils'\n\nconst document = _document as Document\n\nexport interface RenderProductTourPreviewOptions {\n    step: ProductTourStep\n    appearance?: ProductTourAppearance\n    parentElement: HTMLElement\n    stepIndex?: number\n    totalSteps?: number\n    style?: JSX.CSSProperties\n}\n\nexport function renderProductTourPreview({\n    step,\n    appearance,\n    parentElement,\n    stepIndex = 0,\n    totalSteps = 1,\n    style,\n}: RenderProductTourPreviewOptions): void {\n    parentElement.innerHTML = ''\n\n    const shadowHost = document.createElement('div')\n    addProductTourCSSVariablesToElement(shadowHost, appearance)\n    parentElement.appendChild(shadowHost)\n    const shadow = shadowHost.attachShadow({ mode: 'open' })\n\n    const stylesheet = getProductTourStylesheet()\n    if (stylesheet) {\n        shadow.appendChild(stylesheet)\n    }\n\n    const renderTarget = document.createElement('div')\n    shadow.appendChild(renderTarget)\n\n    const isSurveyStep = step.type === 'survey'\n    const isBannerStep = step.type === 'banner'\n    const isModal = !hasElementTarget(step)\n    const tooltipClass = `ph-tour-tooltip${isModal ? ' ph-tour-tooltip--modal' : ''}${isSurveyStep ? ' ph-tour-survey-step' : ''}`\n\n    if (isBannerStep) {\n        render(\n            <div class=\"ph-tour-container\">\n                <ProductTourBanner step={step} onDismiss={() => {}} />\n            </div>,\n            renderTarget\n        )\n        return\n    }\n\n    render(\n        <div class=\"ph-tour-container\">\n            <div\n                class={tooltipClass}\n                style={{\n                    position: 'relative',\n                    animation: 'none',\n                    ...(step.maxWidth && { width: `${step.maxWidth}px`, maxWidth: `${step.maxWidth}px` }),\n                    ...style,\n                }}\n            >\n                {isSurveyStep ? (\n                    <ProductTourSurveyStepInner\n                        step={step}\n                        appearance={appearance}\n                        stepIndex={stepIndex}\n                        totalSteps={totalSteps}\n                    />\n                ) : (\n                    <ProductTourTooltipInner\n                        step={step}\n                        appearance={appearance}\n                        stepIndex={stepIndex}\n                        totalSteps={totalSteps}\n                    />\n                )}\n            </div>\n        </div>,\n        renderTarget\n    )\n}\n"]}