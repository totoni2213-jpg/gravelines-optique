{"version":3,"file":"product-tour-event-receiver.js","sourceRoot":"","sources":["../../../src/utils/product-tour-event-receiver.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA,0CAAsD;AACtD,8EAAkF;AAElF,mDAAgD;AAChD,mCAAuC;AACvC,sCAAuC;AACvC,mEAA4G;AAE5G,IAAM,MAAM,GAAG,IAAA,qBAAY,EAAC,+BAA+B,CAAC,CAAA;AAE5D;IAA8C,4CAA0B;IACpE,kCAAY,QAAiB;QACzB,OAAA,MAAK,YAAC,QAAQ,CAAC,SAAA;IACnB,CAAC;IAES,mDAAgB,GAA1B;QACI,OAAO,mCAAuB,CAAA;IAClC,CAAC;IAES,qDAAkB,GAA5B;QACI,OAAO,kDAAoB,CAAC,KAAK,CAAA;IACrC,CAAC;IAES,4CAAS,GAAnB,UAAoB,QAAwC;;QACxD,MAAA,MAAA,IAAI,CAAC,SAAS,0CAAE,YAAY,0CAAE,eAAe,CAAC,QAAQ,CAAC,CAAA;IAC3D,CAAC;IAES,qDAAkB,GAA5B,UAA6B,MAAc;;QACvC,MAAA,MAAA,IAAI,CAAC,SAAS,0CAAE,YAAY,0CAAE,iBAAiB,CAAC,MAAM,CAAC,CAAA;IAC3D,CAAC;IAES,6CAAU,GAApB;QACI,OAAO,MAAM,CAAA;IACjB,CAAC;IAES,+DAA4B,GAAtC,UAAuC,MAAe;QAClD,IAAI,CAAC,MAAM;YAAE,OAAO,IAAI,CAAA;QACxB,IAAM,YAAY,GAAG,UAAG,qCAAyB,SAAG,MAAM,CAAE,CAAA;QAC5D,IAAM,YAAY,GAAG,UAAG,qCAAyB,SAAG,MAAM,CAAE,CAAA;QAC5D,OAAO,CAAC,CAAC,CAAC,oBAAU,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,oBAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAA;IAC7E,CAAC;IAED,2CAAQ,GAAR;QACI,OAAO,IAAI,CAAC,eAAe,EAAE,CAAA;IACjC,CAAC;IACL,+BAAC;AAAD,CAAC,AAnCD,CAA8C,8BAAa,GAmC1D;AAnCY,4DAAwB","sourcesContent":["import { PRODUCT_TOURS_ACTIVATED } from '../constants'\nimport { ProductTour, ProductTourEventName } from '../posthog-product-tours-types'\nimport { PostHog } from '../posthog-core'\nimport { EventReceiver } from './event-receiver'\nimport { createLogger } from './logger'\nimport { localStore } from '../storage'\nimport { TOUR_COMPLETED_KEY_PREFIX, TOUR_DISMISSED_KEY_PREFIX } from '../extensions/product-tours/constants'\n\nconst logger = createLogger('[Product Tour Event Receiver]')\n\nexport class ProductTourEventReceiver extends EventReceiver<ProductTour> {\n    constructor(instance: PostHog) {\n        super(instance)\n    }\n\n    protected _getActivatedKey(): string {\n        return PRODUCT_TOURS_ACTIVATED\n    }\n\n    protected _getShownEventName(): string {\n        return ProductTourEventName.SHOWN\n    }\n\n    protected _getItems(callback: (items: ProductTour[]) => void): void {\n        this._instance?.productTours?.getProductTours(callback)\n    }\n\n    protected _cancelPendingItem(itemId: string): void {\n        this._instance?.productTours?.cancelPendingTour(itemId)\n    }\n\n    protected _getLogger(): ReturnType<typeof createLogger> {\n        return logger\n    }\n\n    protected _isItemPermanentlyIneligible(itemId?: string): boolean {\n        if (!itemId) return true\n        const completedKey = `${TOUR_COMPLETED_KEY_PREFIX}${itemId}`\n        const dismissedKey = `${TOUR_DISMISSED_KEY_PREFIX}${itemId}`\n        return !!(localStore._get(completedKey) || localStore._get(dismissedKey))\n    }\n\n    getTours(): string[] {\n        return this.getActivatedIds()\n    }\n}\n"]}